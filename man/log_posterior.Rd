% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PCPrior.R
\name{log_posterior}
\alias{log_posterior}
\title{Calculates  the log-posterior density for parameters (log_kappa,v, log_sigma_u, log_sigma_epsilon) with PC prior.}
\usage{
log_posterior(
  mesh,
  log_kappa,
  v,
  log_sigma_u = 0,
  log_sigma_epsilon,
  lambda,
  lambda1,
  lambda_epsilon,
  lambda_u = 1,
  y,
  A,
  m_u
)
}
\arguments{
\item{mesh}{The mesh}

\item{log_kappa}{Logarithm of inverse correlation range}

\item{v}{2D vector that controls anisotropy}

\item{log_sigma_u}{Variance of field u. If unspecified, it is assumed to be 0.}

\item{log_sigma_epsilon}{Variance of noise}

\item{lambda}{A hyperparameter controlling the size of kappa.}

\item{lambda1}{A hyperparameter controlling the size of |v|.}

\item{lambda_epsilon}{A hyperparameter controlling the size of sigma_epsilon.}

\item{lambda_u}{A hyperparameter controlling the size of sigma_u.}

\item{y}{A vector with length equal to the number of basis elements n representing the observed data.}

\item{A}{Matrix of size nxn representing the transformation A}

\item{m_u}{A vector with length n representing the prior mean m_u. If a number is given is transformed into (m_u, m_u,..., m_u)}

\item{Q_epsilon}{A sparse matrix of size nxn representing the noise precision matrix}
}
\value{
The calculated log-posterior
}
\description{
Calculates  the log-posterior density of parameters (log(kappa),v, log(sigma_u), log(epsilon)))
given a linear noisy observation y= A*u + epsilon
Uses based on the prior density and the likelihood.
Only stationary parameters are accepted.
Value is up to an additive constant depending only on y
}
