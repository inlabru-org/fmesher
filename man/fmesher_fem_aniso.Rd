% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{fmesher_fem_aniso}
\alias{fmesher_fem_aniso}
\title{Anisotropic finite element matrix computation}
\usage{
fmesher_fem_aniso(mesh_loc, mesh_tv, aniso, options)
}
\arguments{
\item{mesh_loc}{numeric matrix; mesh vertex coordinates}

\item{mesh_tv}{3-column integer matrix with 0-based vertex indices for each triangle}

\item{aniso}{A \code{list(kappa, v)}. Which can be given per triangle or vertex.
Calculates anisotropic structure matrices for
an anisotropic operator \eqn{\kappa^2-\nabla\cdot H \nabla}{kappa^2-div H grad}.
Here \eqn{\kappa>0,v=(v_1,v_2)\in\mathbb{R}^2}{kappa>0,v=(v1,v2) in R^2} and
\eqn{H=e^{|v|}\tilde{v}\tilde{v}^T+e^{-|v|}\tilde{v}_\perp\tilde{v}^T_\perp}{H = H = exp(|v|) * v_tilde * v_tilde' + exp(-|v|) * v_tilde_perp * v_tilde_perp'}., where
and \eqn{\tilde{v}=|v| e^{i \alpha /2 }, \alpha := \arctan(v_2 /v_1)}{v_tilde=|v|exp(i alpha /2),arctan(v2 /v1)}.}

\item{options}{list of triangulation options (\code{sphere_tolerance})}
}
\value{
A list of matrices
}
\description{
Construct finite element structure matrices
}
\examples{
loc <- matrix(rnorm(20), 10, 2)
loc_sf <- sf::st_geometry(sf::st_as_sf(as.data.frame(loc), coords = 1:2))
loc_sp <- sf::as_Spatial(loc_sf)
boundary_sf <- fm_extensions(loc, c(1, 3))
mesh <- fm_mesh_2d_inla(boundary = boundary_sf, max.edge = c(0.5, 2))
plot(mesh)

kappa <- function(xi) {
return(sum(xi^2))
}

vec <- function(xi) {
return(c(xi[1] + 1, xi[2] - 2))
}

nodes <- mesh$loc

kappa_values <- apply(nodes, 1, kappa)
vec_values <- t(apply(nodes, 1, vec))
aniso=list(kappa_values,vec_values)
a<-fm_fem_aniso(mesh,aniso)
}
